<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Quantum Oracle</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –¢–µ–ª–µ–≥—Ä–∞–º –°–∫—Ä–∏–ø—Ç -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        /* –®—Ä–∏—Ñ—Ç—ã */
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&display=swap');

        /* –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–æ–≤ */
        :root {
            --bg: #050014;
            --gold: #FFD700;
            --purple: #B026FF;
        }

        /* –°–±—Ä–æ—Å —Å—Ç–∏–ª–µ–π */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0; padding: 0;
            background-color: var(--bg);
            color: white;
            font-family: 'Inter', sans-serif;
            height: 100vh; width: 100vw;
            overflow: hidden; /* –ß—Ç–æ–±—ã –Ω–µ —Å–∫—Ä–æ–ª–ª–∏–ª–æ—Å—å –ª–∏—à–Ω–µ–µ */
            display: flex; flex-direction: column;
        }

        /* –ó–≤–µ–∑–¥–Ω—ã–π —Ñ–æ–Ω */
        .stars { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(circle at center, #1a0b2e 0%, #000000 100%); }
        .star { position: absolute; background: white; border-radius: 50%; animation: blink 3s infinite; }
        @keyframes blink { 0%,100%{opacity:0;} 50%{opacity:1;} }

        /* –£—Ç–∏–ª–∏—Ç—ã */
        .hidden { display: none !important; }
        h1, h2, h3, .font-oracle { font-family: 'Cinzel', serif; }
        
        /* –°–¶–ï–ù–´ */
        .scene { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; padding: 20px; }

        /* –í–í–û–î –î–ê–¢–´ */
        input[type="date"] {
            background: #111; border: 1px solid #444; color: white;
            padding: 15px; font-size: 18px; border-radius: 10px; width: 100%; max-width: 280px;
            text-align: center; font-family: 'Inter', sans-serif; text-transform: uppercase;
            margin-bottom: 20px; outline: none;
        }
        
        /* –ö–ù–û–ü–ö–ê –°–¢–ê–†–¢ */
        .btn-start {
            background: linear-gradient(90deg, #B026FF, #7c1dba); color: white;
            padding: 15px 40px; border-radius: 10px; border: none; font-size: 16px;
            text-transform: uppercase; font-weight: bold; opacity: 0.5; pointer-events: none;
            transition: 0.3s;
        }
        .btn-start.active { opacity: 1; pointer-events: all; box-shadow: 0 0 15px var(--purple); }

        /* –ó–ê–ì–†–£–ó–ö–ê */
        .loader {
            width: 80px; height: 80px; border: 3px solid rgba(255,215,0,0.3);
            border-top-color: var(--gold); border-radius: 50%; animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* –†–ï–ó–£–õ–¨–¢–ê–¢ */
        #scene-result { justify-content: flex-start; overflow-y: auto; padding-bottom: 120px; } /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É –¥–ª—è –∫–Ω–æ–ø–∫–∏ */
        
        .card {
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px; padding: 15px; width: 100%; margin-bottom: 10px; text-align: center;
        }
        .text-gold { color: var(--gold); }
        .big-num { font-size: 28px; font-weight: bold; font-family: 'Cinzel', serif; }

        /* –ë–õ–û–ö –û–®–ò–ë–ö–ò */
        .error-box {
            border: 1px solid #FF3333; background: rgba(255, 51, 51, 0.1);
            padding: 15px; border-radius: 12px; width: 100%; margin-top: 10px; text-align: center;
        }
        .blur { filter: blur(5px); user-select: none; }

        /* ========================================= */
        /* –§–ò–ö–° –î–õ–Ø –ê–ô–§–û–ù–ê (–°–ê–ú–û–ï –í–ê–ñ–ù–û–ï)            */
        /* ========================================= */
        .fixed-bottom {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            /* –£—á–∏—Ç—ã–≤–∞–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—É—é –∑–æ–Ω—É –ê–π—Ñ–æ–Ω–∞ + –æ—Ç—Å—Ç—É–ø */
            padding: 20px;
            padding-bottom: calc(20px + env(safe-area-inset-bottom));
            
            /* –ì—Ä–∞–¥–∏–µ–Ω—Ç, —á—Ç–æ–±—ã –∫–Ω–æ–ø–∫–∞ –Ω–µ –≤–∏—Å–µ–ª–∞ –≤ –≤–æ–∑–¥—É—Ö–µ */
            background: linear-gradient(to top, #050014 90%, transparent);
            
            /* –ü–æ–¥–Ω–∏–º–∞–µ–º –Ω–∞–¥ –≤—Å–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–º */
            z-index: 9999; 
        }

        .btn-buy {
            width: 100%;
            background: linear-gradient(90deg, #FFD700, #FFC000);
            color: black;
            font-size: 18px;
            font-weight: 900;
            padding: 16px;
            border-radius: 12px;
            border: none;
            text-transform: uppercase;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
            font-family: 'Cinzel', serif;
            cursor: pointer;
            /* –ß—Ç–æ–±—ã –Ω–∞–∂–∏–º–∞–ª–æ—Å—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ */
            touch-action: manipulation; 
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞—Ü–∏–∏ */
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%{transform:scale(1);} 50%{transform:scale(1.02);} 100%{transform:scale(1);} }

    </style>
</head>
<body>

    <div class="stars" id="stars"></div>

    <!-- –°–¶–ï–ù–ê 1: –í–í–û–î -->
    <div id="scene-input" class="scene">
        <h1 class="text-gold" style="font-size: 32px; text-align: center; margin-bottom: 5px;">QUANTUM<br>ORACLE</h1>
        <p style="color: #b026ff; font-size: 12px; text-transform: uppercase; margin-bottom: 40px;">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</p>
        
        <input type="date" id="date-input">
        <button id="btn-start" class="btn-start">–ù–ê–ß–ê–¢–¨ –°–ö–ê–ù</button>
    </div>

    <!-- –°–¶–ï–ù–ê 2: –ó–ê–ì–†–£–ó–ö–ê -->
    <div id="scene-process" class="scene hidden">
        <div class="loader"></div>
        <p id="process-text" style="color: #00ff9d; font-family: monospace; margin-top: 20px;">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</p>
    </div>

    <!-- –°–¶–ï–ù–ê 3: –†–ï–ó–£–õ–¨–¢–ê–¢ -->
    <div id="scene-result" class="scene hidden">
        <h2 class="text-gold">–ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù</h2>
        
        <div style="display: flex; gap: 10px; width: 100%; margin-top: 20px;">
            <div class="card" style="border-color: #FFD700;">
                <div style="font-size: 10px; color: #FFD700;">–ß–ò–°–õ–û –ü–£–¢–ò</div>
                <div id="res-path" class="big-num text-gold">0</div>
            </div>
            <div class="card" style="border-color: #B026FF;">
                <div style="font-size: 10px; color: #B026FF;">–°–¢–ò–•–ò–Ø</div>
                <div id="res-elem" class="big-num" style="color: white; font-size: 20px;">–≠—Ñ–∏—Ä</div>
            </div>
        </div>

        <div class="card" style="margin-top: 10px; position: relative; overflow: hidden;">
            <div style="position: absolute; right: 10px; top: 10px; font-size: 40px; opacity: 0.1;">üé¥</div>
            <div style="font-size: 10px; opacity: 0.7;">–í–ê–® –ê–†–ö–ê–ù</div>
            <div id="res-arcana" class="big-num text-white" style="font-size: 22px;">–®—É—Ç</div>
            <p style="font-size: 11px; opacity: 0.7; margin-top: 5px;">–°–∏–º–≤–æ–ª —Å–≤–æ–±–æ–¥—ã –∏ –Ω–∞—á–∞–ª–∞ –ø—É—Ç–∏.</p>
        </div>

        <div class="error-box">
            <div style="color: #FF3333; font-weight: bold; font-size: 14px;">‚ö†Ô∏è –û–®–ò–ë–ö–ê –î–û–°–¢–£–ü–ê</div>
            <div style="color: #ffcccc; font-size: 10px; margin-bottom: 10px;">–§–ò–ù–ê–ù–°–û–í–´–ô –ö–ê–ù–ê–õ –ü–ï–†–ï–ö–†–´–¢</div>
            <div style="position: relative;">
                <p class="blur">–¢–µ–∫—Å—Ç –∫–∞—Ä–º–∏—á–µ—Å–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å–∫—Ä—ã—Ç –∏–∑-–∑–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–∞–Ω–∞–ª–∞...</p>
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); font-size: 24px;">üîí</div>
            </div>
        </div>

        <!-- –ö–ù–û–ü–ö–ê (–° –§–ò–ö–°–û–ú –î–õ–Ø –ê–ô–§–û–ù–ê) -->
        <div class="fixed-bottom">
            <button onclick="buyAccess()" class="btn-buy pulse">
                –°–ù–Ø–¢–¨ –ë–õ–û–ö (250 ‚≠êÔ∏è)
            </button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
        // –ö—Ä–∞—Å–∏–º —à–∞–ø–∫—É –¢–µ–ª–µ–≥—Ä–∞–º–∞ –≤ —á–µ—Ä–Ω—ã–π, —á—Ç–æ–±—ã —Å–ª–∏–≤–∞–ª–æ—Å—å
        tg.setHeaderColor('#050014');
        tg.setBackgroundColor('#050014');

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ HTML)
        function buyAccess() {
            // –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ (–ø—Ä–∏—è—Ç–Ω–æ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ)
            if(tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            tg.sendData(JSON.stringify({action: 'buy'}));
            
            // –ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –∑–∞–∫—Ä—ã–≤–∞–µ–º, —Ö–æ—Ç—è sendData –∏ —Ç–∞–∫ –∑–∞–∫—Ä–æ–µ—Ç
            setTimeout(() => tg.close(), 100); 
        }

        // –õ–æ–≥–∏–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        const dateInput = document.getElementById('date-input');
        const btnStart = document.getElementById('btn-start');

        dateInput.addEventListener('change', (e) => {
            if(e.target.value) btnStart.classList.add('active');
        });

        btnStart.addEventListener('click', () => {
            if(!dateInput.value) return;

            // –§–µ–π–∫–æ–≤–∞—è –Ω—É–º–µ—Ä–æ–ª–æ–≥–∏—è
            let val = dateInput.value;
            let sum = val.replace(/-/g,'').split('').reduce((a,b)=>+a + +b, 0);
            while(sum>9) sum = sum.toString().split('').reduce((a,b)=>+a + +b, 0);
            
            const day = parseInt(val.split('-')[2]);
            const month = parseInt(val.split('-')[1]);
            const elems = ["–í–æ–¥–∞", "–ó–µ–º–ª—è", "–û–≥–æ–Ω—å", "–í–æ–∑–¥—É—Ö"];

            document.getElementById('res-path').innerText = sum;
            document.getElementById('res-elem').innerText = elems[Math.floor((month%12)/3)];
            document.getElementById('res-arcana').innerText = (day > 22 ? day - 22 : day);

            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞
            document.getElementById('scene-input').classList.add('hidden');
            document.getElementById('scene-process').classList.remove('hidden');

            // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
            let w = 0;
            const texts = ["–°–≤—è–∑—å —Å —Å–µ—Ä–≤–µ—Ä–æ–º...", "–ß—Ç–µ–Ω–∏–µ –î–ù–ö...", "–ê–Ω–∞–ª–∏–∑ –∫–∞—Ä–º—ã...", "–û–®–ò–ë–ö–ê..."];
            let tStep = 0;
            
            setInterval(() => {
                if(tStep < texts.length) document.getElementById('process-text').innerText = texts[tStep++];
            }, 800);

            setTimeout(() => {
                document.getElementById('scene-process').classList.add('hidden');
                document.getElementById('scene-result').classList.remove('hidden');
            }, 3500);
        });

        // –ó–≤–µ–∑–¥—ã
        const starCont = document.getElementById('stars');
        for(let i=0; i<30; i++) {
            let s = document.createElement('div'); s.className='star';
            s.style.left = Math.random()*100+'%'; s.style.top = Math.random()*100+'%';
            s.style.width = Math.random()*3+'px'; s.style.height = s.style.width;
            s.style.animationDelay = Math.random()*2+'s';
            starCont.appendChild(s);
        }
    </script>
</body>
</html>